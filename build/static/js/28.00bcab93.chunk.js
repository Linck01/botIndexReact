(this["webpackJsonpberry-material-react"]=this["webpackJsonpberry-material-react"]||[]).push([[28],{439:function(e,t,r){"use strict";var a=r(156),n=r(157);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(r(0));var c=a(r(158)),s=r(1),i=(0,c.default)((0,s.jsx)("path",{d:"M18.5 16H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h12.5c1.38 0 2.5 1.12 2.5 2.5S20.88 13 19.5 13H9c-.55 0-1-.45-1-1s.45-1 1-1h9.5V9.5H9c-1.38 0-2.5 1.12-2.5 2.5s1.12 2.5 2.5 2.5h10.5c2.21 0 4-1.79 4-4s-1.79-4-4-4H7c-3.04 0-5.5 2.46-5.5 5.5s2.46 5.5 5.5 5.5h11.5V16z"}),"AttachmentTwoTone");t.default=i},440:function(e,t,r){"use strict";var a=r(156),n=r(157);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=n(r(0)),s=a(r(158)),i=r(1),l=(0,s.default)((0,i.jsxs)(c.Fragment,{children:[(0,i.jsx)("path",{d:"M4 8.25l7.51 1-7.5-3.22zm.01 9.72l7.5-3.22-7.51 1z",opacity:".3"}),(0,i.jsx)("path",{d:"M2.01 3L2 10l15 2-15 2 .01 7L23 12 2.01 3zM4 8.25V6.03l7.51 3.22-7.51-1zm.01 9.72v-2.22l7.51-1-7.51 3.22z"})]}),"SendTwoTone");t.default=l},629:function(e,t,r){"use strict";r.r(t);var a=r(24),n=r(14),c=r(3),s=r(23),i=r(15),l=r(0),o=r.n(l),u=r(27),j=r(21),b=r(109),d=r(247),p=r(30),O=r(193),h=r(311),f=r(352),m=r(322),x=r(302),v=r(298),g=r(616),y=r(16),k=r(119),S=r.n(k),w=r(388),z=r.n(w),M=r(155),C=r(66),E=r(1),H=function(e){e.theme;var t=e.data,r=e.scrollBarEl,a=Object(l.useRef)(document.createElement("div")),n=a.current,c=Object(l.useCallback)((function(){r&&(r.scrollTop=r.scrollHeight)}),[n]);return Object(l.useEffect)((function(){c()}),[t.length,r]),Object(E.jsx)(h.a,{container:!0,spacing:C.b,ref:a,children:t.map((function(e,t){return Object(E.jsx)(o.a.Fragment,{children:Object(E.jsx)(h.a,{container:!0,direction:"column",spacing:1,children:Object(E.jsxs)(h.a,{item:!0,style:{marginBottom:"2px"},children:[Object(E.jsx)(M.a,{variant:"title",color:"secondary.200",children:e.user.username+": "}),Object(E.jsx)(M.a,{variant:"subheading",children:e.message})]})})},t)}))})},A=r(159),I=r(48),T=r(44),_=r(67),B=r(439),R=r.n(B),F=r(440),P=r.n(F),q=r(389),D=r.n(q),K=Object(d.a)((function(e){return{ScrollHeight:{width:"100%",height:"calc(100vh - 220px)",overflowX:"hidden",minHeight:"10px"}}}));t.default=function(e){e.openChatDrawer,e.handleChatDrawerOpen;var t=K(),r=Object(p.a)(),d=Object(u.b)(),k=Object(T.a)().user,M=Object(l.useContext)(_.b),C=M.game,B=M.socket,F=M.chat,q=M.setChat,N=Object(l.useRef)(),V=Object(l.useRef)(),J=Object(l.useState)(!0),L=Object(i.a)(J,2),W=L[0],U=L[1],X=Object(l.useState)(!1),G=Object(i.a)(X,2),Q=G[0],Y=G[1],Z=function(){var e=Object(s.a)(Object(n.a)().mark((function e(){var t;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U(!0),e.prev=1,e.next=4,I.a.get(j.a.gameHosts[C.serverId]+"/v1/messages/",{params:{gameId:C.id,sortBy:"-_createdAt",limit:100,page:0}});case 4:t=e.sent,q(Object(c.a)(Object(c.a)({},F),{},{isInitialized:!0,items:t.data.results.reverse()})),U(!1),e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(1),U(!1),console.log(e.t0),e.abrupt("return",d({type:y.r,open:!0,message:e.t0.response?e.t0.response.data.message:e.t0.toString(),variant:"alert",alertSeverity:"error",close:!0}));case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();Object(l.useEffect)((function(){return B&&B.on("chatMessage",(function(e){var t=[].concat(Object(a.a)(F.items),[e]);q(Object(c.a)(Object(c.a)({},F),{},{items:t}))})),function(){B&&B.off("chatMessage")}}),[B,F]),Object(l.useEffect)((function(){Z()}),[]);var $=function(){var e=Object(s.a)(Object(n.a)().mark((function e(){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Q){e.next=2;break}return e.abrupt("return");case 2:if(k){e.next=4;break}return e.abrupt("return",d({type:y.r,open:!0,message:"Please log in to send a message!",variant:"alert",alertSeverity:"error",close:!0}));case 4:return Y(!0),e.prev=5,e.next=8,I.a.post(j.a.gameHosts[C.serverId]+"/v1/messages/",{userId:k.id,gameId:C.id,message:N.current.querySelectorAll("input[type=text]")[0].value});case 8:N.current.querySelectorAll("input[type=text]")[0].value="",Y(!1),e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(5),Y(!1),e.abrupt("return",d({type:y.r,open:!0,message:e.t0.response?e.t0.response.data.message:e.t0.toString(),variant:"alert",alertSeverity:"error",close:!0}));case 16:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(){return e.apply(this,arguments)}}(),ee=o.a.useState(null),te=Object(i.a)(ee,2),re=te[0],ae=te[1],ne=Boolean(re),ce=ne?"simple-popper":void 0,se=o.a.useState(null),ie=Object(i.a)(se,2),le=ie[0],oe=ie[1];return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(b.a,{children:Object(E.jsxs)("title",{children:[C.title," - Chat"]})}),Object(E.jsx)(A.a,{sx:{bgcolor:"dark"===r.palette.mode?"dark.main":"grey.50"},children:Object(E.jsx)(S.a,{className:t.ScrollHeight,containerRef:function(e){oe(e)},children:Object(E.jsx)(O.a,{children:W?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("br",{}),Object(E.jsx)(h.a,{container:!0,justifyContent:"center",children:Object(E.jsx)(f.a,{color:"secondary",size:"10em"})})]}):Object(E.jsx)(H,{theme:r,data:F.items,scrollBarEl:le,scrollBarRef:V})})})}),Object(E.jsx)("br",{}),Object(E.jsx)(h.a,{item:!0,xs:12,children:Object(E.jsxs)(h.a,{container:!0,spacing:1,alignItems:"center",children:[Object(E.jsxs)(h.a,{item:!0,children:[Object(E.jsx)(m.a,{ref:re,"aria-describedby":ce,size:"small",onClick:function(e){ae(re?null:e.currentTarget)},children:Object(E.jsx)(D.a,{})}),Object(E.jsx)(x.a,{position:"top",id:ce,open:ne,anchorEl:re,disablePortal:!0,popperOptions:{modifiers:[{name:"offset",options:{offset:[-20,20]}}]},children:Object(E.jsx)(v.a,{onClickAway:function(){ae(null)},children:Object(E.jsxs)(A.a,{elevation:8,content:!1,children:[" ",Object(E.jsx)(z.a,{onEmojiClick:function(e,t){N.current.querySelectorAll("input[type=text]")[0].value=N.current.querySelectorAll("input[type=text]")[0].value+t.emoji},skinTone:w.SKIN_TONE_MEDIUM_DARK,disableAutoFocus:!0})]})})})]}),Object(E.jsx)(h.a,{item:!0,xs:!0,zeroMinWidth:!0,children:Object(E.jsx)(g.a,{fullWidth:!0,label:"Type a Message",variant:"outlined",ref:N,onKeyPress:function(e){"Enter"===e.key&&$()}})}),Object(E.jsx)(h.a,{item:!0,children:Object(E.jsx)(m.a,{size:"small",children:Object(E.jsx)(R.a,{})})}),Object(E.jsx)(h.a,{item:!0,children:Object(E.jsx)(m.a,{size:"small",color:"primary",onClick:$,children:Object(E.jsx)(P.a,{})})})]})})]})}}}]);
//# sourceMappingURL=28.00bcab93.chunk.js.map